[
    {
        "content": "<p>Failed to parse /nix/store/hk9ikz0hwh3swvqmcwmgcr5dxw1f736p-source/cabal.project: {\"type\":\"error\",\"value\":{\"context\":\"parsec.string\",\"msg\":\"expected string 'packages:'\",\"offset\":0,\"str\":\"-- Generated by stackage-to-hackage<br>\nwith-compiler: ghc-8.10.7 .......<br>\nSample cabal.project</p>\n<div class=\"codehilite\"><pre><span></span><code>-- Generated by stackage-to-hackage\n\nwith-compiler: ghc-8.10.7\n\npackages:\n    ./\n\nsource-repository-package\n    type: git\n    location: https://github.com/aravindgopall/hsaml2.git\n    tag: d4ecf51a0bf3733eb1ff8724a691b0200b3355ee\n\nallow-older: *\nallow-newer: *\n</code></pre></div>",
        "id": 422383676,
        "sender_full_name": "Neeraj",
        "timestamp": 1708423391
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"691894\">@Neeraj</span> The cabal.project parser is pretty <a href=\"https://github.com/srid/haskell-flake/tree/master/nix/haskell-parsers#limitations\">limited</a>.</p>\n<p>Move <code>packages:</code> to the first line, and see if that works.</p>",
        "id": 422402321,
        "sender_full_name": "Srid",
        "timestamp": 1708430446
    },
    {
        "content": "<p>And it will only recognizes <code>packages</code>, not others. You have to specify them in Nix.</p>",
        "id": 422402358,
        "sender_full_name": "Srid",
        "timestamp": 1708430461
    },
    {
        "content": "<p>The first two lines should look like:</p>\n<div class=\"codehilite\"><pre><span></span><code>‚ùØ head -n 2 cabal.project\npackages:\n    ./\n</code></pre></div>",
        "id": 422402745,
        "sender_full_name": "Srid",
        "timestamp": 1708430608
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"667408\">Srid</span> <a href=\"#narrow/stream/413949-haskell-flake/topic/Failed.20to.20parse.20.60cabal.2Eproject.60/near/422402358\">said</a>:</p>\n<blockquote>\n<p>And it will only recognizes <code>packages</code>, not others. You have to specify them in Nix.</p>\n</blockquote>\n<p>For eg., <code>source-repository-package</code> should be specified as flake inputs and used as a dependency override. See <a href=\"https://community.flake.parts/haskell-flake/dependency#path\">https://community.flake.parts/haskell-flake/dependency#path</a></p>",
        "id": 422402890,
        "sender_full_name": "Srid",
        "timestamp": 1708430670
    },
    {
        "content": "<p>(Oops, I realized I linked to haskell-flake docs but of course you'd use the same <code>callCabal2nix</code> function to specify these source-repository-package using flake inputs)</p>",
        "id": 422608668,
        "sender_full_name": "Srid",
        "timestamp": 1708519444
    },
    {
        "content": "<p>How to exclude <code>cabal.project</code>  so that nix will not parse it?</p>",
        "id": 422768326,
        "sender_full_name": "Neeraj",
        "timestamp": 1708590402
    },
    {
        "content": "<p>got it. Using <a href=\"https://github.com/numtide/nix-filter\">nix-filter</a> solved it</p>",
        "id": 422771217,
        "sender_full_name": "Neeraj",
        "timestamp": 1708591608
    }
]